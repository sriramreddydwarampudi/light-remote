(()=>{"use strict";var e={3844:(e,t,r)=>{var n=r(9366),i=r(6665),a=r(5991),s=r(397);const o="undefined"!==typeof window&&!a.default;let l=null,c=null;!o&&(l=r(7379),c=r(3731));class d{constructor(){this.port=null,this.reader=null,this.writer=null,this.connected=!1}async isAvailable(){return"serial"in navigator}async requestDevice(){try{this.port=await navigator.serial.requestPort(),await this.port.open({baudRate:9600}),this.connected=!0;const e=new TextDecoderStream;this.port.readable.pipeTo(e.writable);this.reader=e.readable.getReader();const t=new TextEncoderStream;t.readable.pipeTo(this.port.writable);return this.writer=t.writable.getWriter(),{name:"Serial Device",address:"WEB"}}catch(e){throw new Error("Failed to connect: "+e.message)}}async write(e){if(!this.writer)throw new Error("Not connected");return await this.writer.write(e),!0}async disconnect(){this.reader&&(await this.reader.cancel(),this.reader=null),this.writer&&(await this.writer.close(),this.writer=null),this.port&&(await this.port.close(),this.port=null),this.connected=!1}onDataReceived(e){if(!this.reader)return;(async()=>{try{for(;;){const{value:t,done:r}=await this.reader.read();if(r)break;t&&e({data:t})}}catch(t){console.error("Read error:",t)}})()}}const p={container:{flex:1,backgroundColor:"#0a0a0a",fontFamily:"system-ui, -apple-system, sans-serif",minHeight:"100vh",color:"#ffffff"},scrollView:{flex:1,overflowY:"auto",padding:"0"},header:{padding:"20px",paddingTop:"40px",backgroundColor:"#1a237e",textAlign:"center"},headerTitle:{fontSize:"24px",fontWeight:"bold",color:"#ffffff",letterSpacing:"2px",margin:"0"},headerSubtitle:{fontSize:"12px",color:"#bbdefb",marginTop:"5px"},dateTime:{fontSize:"14px",color:"#ffffff",marginTop:"10px",fontWeight:"500"},card:{backgroundColor:"#1e1e1e",margin:"10px",padding:"15px",borderRadius:"8px",border:"1px solid #333"},cardTitle:{fontSize:"18px",fontWeight:"bold",color:"#ffffff",marginBottom:"15px",borderBottom:"1px solid #333",paddingBottom:"10px",marginTop:"0"},actionButtons:{display:"flex",gap:"10px",marginBottom:"15px"},actionBtn:{flex:1,padding:"12px",borderRadius:"5px",border:"none",cursor:"pointer",fontWeight:"bold",fontSize:"12px",color:"#ffffff"},pairBtn:{backgroundColor:"#2196F3"},updateBtn:{backgroundColor:"#FF9800"},getDataBtn:{backgroundColor:"#4CAF50"},disconnectBtn:{backgroundColor:"#F44336",width:"100%",marginTop:"10px"},connectionStatus:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row"},statusText:{color:"#ffffff",fontSize:"14px"},statusDot:{width:"10px",height:"10px",borderRadius:"5px",margin:"0 5px"},modeSelector:{display:"flex",gap:"10px",marginBottom:"15px"},modeBtn:{flex:1,padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"5px",border:"2px solid #444",cursor:"pointer",textAlign:"center"},modeBtnActive:{backgroundColor:"#1976D2",borderColor:"#2196F3"},modeBtnText:{color:"#999",fontSize:"11px",fontWeight:"600",whiteSpace:"pre-line"},modeBtnTextActive:{color:"#ffffff"},inputGroup:{marginBottom:"15px"},inputLabel:{color:"#bbdefb",fontSize:"14px",marginBottom:"8px",fontWeight:"500",display:"block"},input:{backgroundColor:"#2a2a2a",color:"#ffffff",padding:"12px",borderRadius:"5px",border:"1px solid #444",fontSize:"16px",width:"100%",boxSizing:"border-box"},timeInputContainer:{display:"flex",alignItems:"center",gap:"10px"},timeInput:{flex:1,textAlign:"center"},timeSeparator:{color:"#ffffff",fontSize:"24px",fontWeight:"bold"},sendBtn:{backgroundColor:"#4CAF50",padding:"15px",borderRadius:"5px",border:"none",cursor:"pointer",fontWeight:"bold",fontSize:"16px",color:"#ffffff",width:"100%",marginTop:"10px"},statusGrid:{display:"flex",flexWrap:"wrap",gap:"10px"},statusItem:{flex:"1 1 45%",minWidth:"45%",backgroundColor:"#2a2a2a",padding:"15px",borderRadius:"5px",border:"1px solid #444"},statusLabel:{color:"#999",fontSize:"12px",marginBottom:"5px",margin:"0 0 5px 0"},statusValue:{color:"#ffffff",fontSize:"18px",fontWeight:"bold",margin:"0"},pickerContainer:{display:"flex",flexWrap:"wrap",gap:"8px"},pickerBtn:{padding:"10px 15px",backgroundColor:"#2a2a2a",borderRadius:"5px",border:"1px solid #444",cursor:"pointer"},pickerBtnActive:{backgroundColor:"#1976D2",borderColor:"#2196F3"},pickerBtnText:{color:"#999",fontSize:"14px"},pickerBtnTextActive:{color:"#ffffff",fontWeight:"bold"},saveBtn:{backgroundColor:"#1976D2",padding:"15px",borderRadius:"5px",border:"none",cursor:"pointer",fontWeight:"bold",fontSize:"16px",color:"#ffffff",width:"100%",marginTop:"10px"},logContainer:{maxHeight:"300px",overflowY:"auto"},logItem:{display:"flex",padding:"8px 0",borderBottom:"1px solid #333"},logTime:{color:"#4CAF50",fontSize:"12px",fontFamily:"monospace",width:"80px",flexShrink:0},logEvent:{color:"#ffffff",fontSize:"12px",flex:1}};(0,n.default)(function(){const[e,t]=(0,i.useState)(new Date),[r,n]=(0,i.useState)(!1),[a,c]=(0,i.useState)(null),[u,h]=(0,i.useState)(!1),[f,x]=(0,i.useState)([]),[g,b]=(0,i.useState)(!1),[y,v]=(0,i.useState)(!1),[m,S]=(0,i.useState)("A"),[j,w]=(0,i.useState)("285"),[B,C]=(0,i.useState)("150"),[T,k]=(0,i.useState)("22"),[A,E]=(0,i.useState)("00"),[D,O]=(0,i.useState)("0"),[F,I]=(0,i.useState)("0"),[$,W]=(0,i.useState)("OFF"),[R,L]=(0,i.useState)("NONE"),[z,P]=(0,i.useState)("9600"),[N,V]=(0,i.useState)("8"),[G,M]=(0,i.useState)("1"),[H,_]=(0,i.useState)("None"),[q,U]=(0,i.useState)([]),[Y,J]=(0,i.useState)(null);(0,i.useEffect)(()=>{const e=setInterval(()=>{t(new Date)},1e3);return o?K():Q(),ce(`App Started (${o?"Web":"React Native"})`),()=>{clearInterval(e),a&&ee()}},[]);const K=async()=>{const e=new d;J(e);const t=await e.isAvailable();v(t),ce(t?"Web Serial API ready (Classic Bluetooth via USB/Serial)":"Web Serial API not supported - Use Chrome/Edge on desktop")},Q=async()=>{try{await Z();const e=await l.isBluetoothEnabled();v(e),e?ce("Bluetooth is ready"):(ce("Bluetooth is disabled"),await X())}catch(e){console.error("Bluetooth initialization error:",e),ce("Bluetooth Init Error: "+e.message)}},X=async()=>{if(!o)try{await l.requestBluetoothEnabled()&&(v(!0),ce("Bluetooth Enabled"))}catch(e){console.error("Enable Bluetooth error:",e),ce("Failed to enable Bluetooth: "+e.message)}},Z=async()=>{},ee=async()=>{try{o&&Y?await Y.disconnect():a&&await a.disconnect(),n(!1),c(null),O("0"),I("0"),W("OFF"),ce("Device Disconnected")}catch(e){console.error("Disconnect error:",e),ce("Disconnect Error: "+e.message)}},te=async e=>{try{if(!r)throw new Error("Device not connected");let t;if(o&&Y?t=await Y.write(e):a&&(t=await a.write(e)),t)return ce(`Sent: ${e}`),!0;throw new Error("Failed to send data")}catch(t){return console.error("Send error:",t),ce("Send Error: "+t.message),alert("Send Error: "+t.message),!1}},re=e=>{try{ce(`Received: ${e}`);try{const t=JSON.parse(e);return void 0!==t.voltage&&O(t.voltage.toString()),void 0!==t.current&&I(t.current.toString()),void 0!==t.status&&W(t.status),void 0!==t.faultCode&&L(t.faultCode),void ce("Device status updated from JSON")}catch(t){}e.split(",").forEach(e=>{e.startsWith("V:")?O(e.substring(2)):e.startsWith("C:")?I(e.substring(2)):e.startsWith("S:")?W(e.substring(2)):e.startsWith("F:")&&L(e.substring(2))})}catch(r){console.error("Parse error:",r),ce("Error parsing data: "+r.message)}},ne=()=>{const e=setInterval(()=>{r?te("GET_DATA\n"):clearInterval(e)},3e3)},ie=async()=>{if(r){if(!window.confirm("Disconnect current device first?"))return;await ee()}await(async()=>{if(o)try{h(!0),ce("Opening serial port selector...");const e=await Y.requestDevice();c(e),n(!0),ce(`Connected to ${e.name}`),Y.onDataReceived(e=>{re(e.data)}),ne(),h(!1)}catch(e){console.error("Connection error:",e),ce("Connection Error: "+e.message),alert("Failed to connect: "+e.message),h(!1)}else try{if(!await l.isBluetoothEnabled()&&(ce("Bluetooth is disabled, requesting to enable..."),await X(),!await l.isBluetoothEnabled()))return;h(!0),b(!0),ce("Scanning for Bluetooth devices...");const e=await l.getBondedDevices(),t=await l.startDiscovery(),r=[...e,...t];x(r),h(!1),0===r.length?ce("No devices found"):ce(`Found ${r.length} device(s)`)}catch(e){console.error("Scan error:",e),ce("Scan Error: "+e.message),h(!1)}})()},ae=async()=>{if(!r)return void alert("Please pair device first");const e=new Date,t=`${(n=e).getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")} ${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}:${String(n.getSeconds()).padStart(2,"0")}`;var n;if(window.confirm(`Send update with current date/time?\n${t}`)){ce(`Sending update with time: ${t}`);const e=`UPDATE_FIRMWARE,DATETIME:${t}\n`;await te(e)&&alert("Firmware update initiated with current date/time")}},se=async()=>{r?(ce("Requesting device data..."),await te("GET_DATA\n")):alert("Please pair device first")},oe=async()=>{if(r)try{const e=`MODE:${m},HV:${j},LV:${B},OFF:${T}:${A}\n`;ce("Sending configuration...");await te(e)&&alert("Configuration sent to device")}catch(e){alert("Error: "+e.message)}else alert("Please pair device first")},le=async()=>{if(r)try{const e=`SETTINGS:BAUD:${z},DATA:${N},STOP:${G},PARITY:${H}\n`;ce("Saving settings...");await te(e)&&alert("Settings saved successfully")}catch(e){alert("Error: "+e.message)}else alert("Please pair device first")},ce=e=>{const t=new Date,r=`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`;U(t=>[{time:r,event:e},...t].slice(0,50))};return o?(0,s.jsxs)("div",{style:p.container,children:[(0,s.jsxs)("div",{style:p.header,children:[(0,s.jsx)("h1",{style:p.headerTitle,children:"Light Remote"}),(0,s.jsx)("p",{style:p.headerSubtitle,children:"BT Controller (Web)"}),(0,s.jsx)("p",{style:p.dateTime,children:(de=e,de.toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}))})]}),(0,s.jsxs)("div",{style:p.scrollView,children:[(0,s.jsxs)("div",{style:p.card,children:[(0,s.jsxs)("div",{style:p.actionButtons,children:[(0,s.jsx)("button",{style:Object.assign({},p.actionBtn,p.pairBtn),onClick:ie,disabled:u,children:r?"PAIRED":u?"CONNECTING...":"PAIR"}),(0,s.jsx)("button",{style:Object.assign({},p.actionBtn,p.updateBtn),onClick:ae,children:"UPDATE"}),(0,s.jsx)("button",{style:Object.assign({},p.actionBtn,p.getDataBtn),onClick:se,children:"GET DATA"})]}),(0,s.jsxs)("div",{style:p.connectionStatus,children:[(0,s.jsx)("span",{style:p.statusText,children:"Status: "}),(0,s.jsx)("div",{style:Object.assign({},p.statusDot,{backgroundColor:r?"#4CAF50":"#F44336"})}),(0,s.jsx)("span",{style:p.statusText,children:r?a?.name||"Connected":"Disconnected"})]}),r&&(0,s.jsx)("button",{style:Object.assign({},p.actionBtn,p.disconnectBtn),onClick:ee,children:"DISCONNECT"})]}),(0,s.jsxs)("div",{style:p.card,children:[(0,s.jsx)("h2",{style:p.cardTitle,children:"Select Mode"}),(0,s.jsx)("div",{style:p.modeSelector,children:["A","B","C"].map(e=>(0,s.jsx)("button",{style:Object.assign({},p.modeBtn,m===e?p.modeBtnActive:{}),onClick:()=>S(e),children:(0,s.jsxs)("span",{style:Object.assign({},p.modeBtnText,m===e?p.modeBtnTextActive:{}),children:["Mode ",e,"\n","A"===e?"Sensor Mode":"B"===e?"Astro Mode":"Clock Mode"]})},e))}),(0,s.jsxs)("div",{style:p.inputGroup,children:[(0,s.jsx)("label",{style:p.inputLabel,children:"High Voltage Cut-off (V)"}),(0,s.jsx)("input",{style:p.input,type:"number",value:j,onChange:e=>w(e.target.value),placeholder:"285"})]}),(0,s.jsxs)("div",{style:p.inputGroup,children:[(0,s.jsx)("label",{style:p.inputLabel,children:"Low Voltage Cut-off (V)"}),(0,s.jsx)("input",{style:p.input,type:"number",value:B,onChange:e=>C(e.target.value),placeholder:"150"})]}),(0,s.jsxs)("div",{style:p.inputGroup,children:[(0,s.jsx)("label",{style:p.inputLabel,children:"Off Time (HH:MM)"}),(0,s.jsxs)("div",{style:p.timeInputContainer,children:[(0,s.jsx)("input",{style:Object.assign({},p.input,p.timeInput),type:"number",value:T,onChange:e=>k(e.target.value),maxLength:2,placeholder:"22"}),(0,s.jsx)("span",{style:p.timeSeparator,children:":"}),(0,s.jsx)("input",{style:Object.assign({},p.input,p.timeInput),type:"number",value:A,onChange:e=>E(e.target.value),maxLength:2,placeholder:"00"})]})]}),(0,s.jsx)("button",{style:p.sendBtn,onClick:oe,children:"SEND"})]}),(0,s.jsxs)("div",{style:p.card,children:[(0,s.jsx)("h2",{style:p.cardTitle,children:"Device Status"}),(0,s.jsxs)("div",{style:p.statusGrid,children:[(0,s.jsxs)("div",{style:p.statusItem,children:[(0,s.jsx)("p",{style:p.statusLabel,children:"Voltage"}),(0,s.jsxs)("p",{style:p.statusValue,children:[D," V"]})]}),(0,s.jsxs)("div",{style:p.statusItem,children:[(0,s.jsx)("p",{style:p.statusLabel,children:"Current"}),(0,s.jsxs)("p",{style:p.statusValue,children:[F," A"]})]}),(0,s.jsxs)("div",{style:p.statusItem,children:[(0,s.jsx)("p",{style:p.statusLabel,children:"Status"}),(0,s.jsx)("p",{style:Object.assign({},p.statusValue,{color:"ON"===$?"#4CAF50":"#F44336"}),children:$})]}),(0,s.jsxs)("div",{style:p.statusItem,children:[(0,s.jsx)("p",{style:p.statusLabel,children:"Fault Code"}),(0,s.jsx)("p",{style:p.statusValue,children:R})]})]})]}),(0,s.jsxs)("div",{style:p.card,children:[(0,s.jsx)("h2",{style:p.cardTitle,children:"Device Settings"}),(0,s.jsxs)("div",{style:p.inputGroup,children:[(0,s.jsx)("label",{style:p.inputLabel,children:"Baud Rate"}),(0,s.jsx)("div",{style:p.pickerContainer,children:["9600","19200","38400","57600","115200"].map(e=>(0,s.jsx)("button",{style:Object.assign({},p.pickerBtn,z===e?p.pickerBtnActive:{}),onClick:()=>P(e),children:(0,s.jsx)("span",{style:Object.assign({},p.pickerBtnText,z===e?p.pickerBtnTextActive:{}),children:e})},e))})]}),(0,s.jsxs)("div",{style:p.inputGroup,children:[(0,s.jsx)("label",{style:p.inputLabel,children:"Data Bits"}),(0,s.jsx)("div",{style:p.pickerContainer,children:["7","8"].map(e=>(0,s.jsx)("button",{style:Object.assign({},p.pickerBtn,N===e?p.pickerBtnActive:{}),onClick:()=>V(e),children:(0,s.jsx)("span",{style:Object.assign({},p.pickerBtnText,N===e?p.pickerBtnTextActive:{}),children:e})},e))})]}),(0,s.jsxs)("div",{style:p.inputGroup,children:[(0,s.jsx)("label",{style:p.inputLabel,children:"Stop Bits"}),(0,s.jsx)("div",{style:p.pickerContainer,children:["1","2"].map(e=>(0,s.jsx)("button",{style:Object.assign({},p.pickerBtn,G===e?p.pickerBtnActive:{}),onClick:()=>M(e),children:(0,s.jsx)("span",{style:Object.assign({},p.pickerBtnText,G===e?p.pickerBtnTextActive:{}),children:e})},e))})]}),(0,s.jsxs)("div",{style:p.inputGroup,children:[(0,s.jsx)("label",{style:p.inputLabel,children:"Parity"}),(0,s.jsx)("div",{style:p.pickerContainer,children:["None","Even","Odd"].map(e=>(0,s.jsx)("button",{style:Object.assign({},p.pickerBtn,H===e?p.pickerBtnActive:{}),onClick:()=>_(e),children:(0,s.jsx)("span",{style:Object.assign({},p.pickerBtnText,H===e?p.pickerBtnTextActive:{}),children:e})},e))})]}),(0,s.jsx)("button",{style:p.saveBtn,onClick:le,children:"SAVE SETTINGS"})]}),(0,s.jsxs)("div",{style:p.card,children:[(0,s.jsx)("h2",{style:p.cardTitle,children:"Event Log"}),(0,s.jsx)("div",{style:p.logContainer,children:q.slice(0,15).map((e,t)=>(0,s.jsxs)("div",{style:p.logItem,children:[(0,s.jsx)("span",{style:p.logTime,children:e.time}),(0,s.jsx)("span",{style:p.logEvent,children:e.event})]},t))})]}),(0,s.jsx)("div",{style:{height:"30px"}})]})]}):null;var de})}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.m=e,(()=>{var e=[];r.O=(t,n,i,a)=>{if(!n){var s=1/0;for(d=0;d<e.length;d++){for(var[n,i,a]=e[d],o=!0,l=0;l<n.length;l++)(!1&a||s>=a)&&Object.keys(r.O).every(e=>r.O[e](n[l]))?n.splice(l--,1):(o=!1,a<s&&(s=a));if(o){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,i,a]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[s,o,l]=n,c=0;if(s.some(t=>0!==e[t])){for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(l)var d=l(r)}for(t&&t(n);c<s.length;c++)a=s[c],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(d)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=r.O(void 0,[670],()=>r(3844));n=r.O(n)})();
//# sourceMappingURL=main.1a3bcb00.js.map